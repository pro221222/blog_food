

 const dataHealth	= [
    {
      "Type": "Health",
      "WebLabel": "Alcohol-Cocktail",
      "APIParameter": "alcohol-cocktail",
      "Definition": "Describes an alcoholic cocktail"
    },
    {
      "Type": "Health",
      "WebLabel": "Alcohol-Free",
      "APIParameter": "alcohol-free",
      "Definition": "No alcohol used or contained"
    },
    {
      "Type": "Health",
      "WebLabel": "Celery-Free",
      "APIParameter": "celery-free",
      "Definition": "Does not contain celery or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Crustcean-Free",
      "APIParameter": "crustacean-free",
      "Definition": "Does not contain crustaceans (shrimp, lobster etc.) or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Dairy-Free",
      "APIParameter": "dairy-free",
      "Definition": "No dairy; no lactose"
    },
    {
      "Type": "Health",
      "WebLabel": "DASH",
      "APIParameter": "DASH",
      "Definition": "Dietary Approaches to Stop Hypertension diet"
    },
    {
      "Type": "Health",
      "WebLabel": "Egg-Free",
      "APIParameter": "egg-free",
      "Definition": "No eggs or products containing eggs"
    },
    {
      "Type": "Health",
      "WebLabel": "Fish-Free",
      "APIParameter": "fish-free",
      "Definition": "No fish or fish derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "FODMAP-Free",
      "APIParameter": "fodmap-free",
      "Definition": "Does not contain FODMAP foods"
    },
    {
      "Type": "Health",
      "WebLabel": "Gluten-Free",
      "APIParameter": "gluten-free",
      "Definition": "No ingredients containing gluten"
    },
    {
      "Type": "Health",
      "WebLabel": "Keto-Friendly",
      "APIParameter": "keto-friendly",
      "Definition": "Maximum 7 grams of net carbs per serving"
    },
    {
      "Type": "Health",
      "WebLabel": "Kidney-Friendly",
      "APIParameter": "kidney-friendly",
      "Definition": "Per serving – phosphorus less than 250 mg AND potassium less than 500 mg AND sodium less than 500 mg"
    },
    {
      "Type": "Health",
      "WebLabel": "Kosher",
      "APIParameter": "kosher",
      "Definition": "Contains only ingredients allowed by the kosher diet. However it does not guarantee kosher preparation of the ingredients themselves"
    },
    {
      "Type": "Health",
      "WebLabel": "Low Potassium",
      "APIParameter": "low-potassium",
      "Definition": "Less than 150mg per serving"
    },
    {
      "Type": "Health",
      "WebLabel": "Low Sugar",
      "APIParameter": "low-sugar",
      "Definition": "No simple sugars – glucose, dextrose, galactose, fructose, sucrose, lactose, maltose"
    },
    {
      "Type": "Health",
      "WebLabel": "Lupine-Free",
      "APIParameter": "lupine-free",
      "Definition": "Does not contain lupine or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Mediterranean",
      "APIParameter": "Mediterranean",
      "Definition": "Mediterranean diet"
    },
    {
      "Type": "Health",
      "WebLabel": "Mollusk-Free",
      "APIParameter": "mollusk-free",
      "Definition": "No mollusks"
    },
    {
      "Type": "Health",
      "WebLabel": "Mustard-Free",
      "APIParameter": "mustard-free",
      "Definition": "Does not contain mustard or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "No oil added",
      "APIParameter": "no-oil-added",
      "Definition": "No oil added except to what is contained in the basic ingredients"
    },
    {
      "Type": "Health",
      "WebLabel": "Paleo",
      "APIParameter": "paleo",
      "Definition": "Excludes what are perceived to be agricultural products; grains, legumes, dairy products, potatoes, refined salt, refined sugar, and processed oils"
    },
    {
      "Type": "Health",
      "WebLabel": "Peanut-Free",
      "APIParameter": "peanut-free",
      "Definition": "No peanuts or products containing peanuts"
    },
    {
      "Type": "Health",
      "WebLabel": "Pescatarian",
      "APIParameter": "pecatarian",
      "Definition": "Does not contain meat or meat based products, can contain dairy and fish"
    },
    {
      "Type": "Health",
      "WebLabel": "Pork-Free",
      "APIParameter": "pork-free",
      "Definition": "Does not contain pork or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Red-Meat-Free",
      "APIParameter": "red-meat-free",
      "Definition": "Does not contain beef, lamb, pork, duck, goose, game, horse, and other types of red meat or products containing red meat."
    },
    {
      "Type": "Health",
      "WebLabel": "Sesame-Free",
      "APIParameter": "sesame-free",
      "Definition": "Does not contain sesame seed or derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Shellfish-Free",
      "APIParameter": "shellfish-free",
      "Definition": "No shellfish or shellfish derivatives"
    },
    {
      "Type": "Health",
      "WebLabel": "Soy-Free",
      "APIParameter": "soy-free",
      "Definition": "No soy or products containing soy"
    },
    {
      "Type": "Health",
      "WebLabel": "Sugar-Conscious",
      "APIParameter": "sugar-conscious",
      "Definition": "Less than 4g of sugar per serving"
    },
    {
      "Type": "Health",
      "WebLabel": "Sulfite-Free",
      "APIParameter": "sulfite-free",
      "Definition": "No Sulfites"
    },
    {
      "Type": "Health",
      "WebLabel": "Tree-Nut-Free",
      "APIParameter": "tree-nut-free",
      "Definition": "No tree nuts or products containing tree nuts"
    },
    {
      "Type": "Health",
      "WebLabel": "Vegan",
      "APIParameter": "vegan",
      "Definition": "No meat, poultry, fish, dairy, eggs or honey"
    },
    {
      "Type": "Health",
      "WebLabel": "Vegetarian",
      "APIParameter": "vegetarian",
      "Definition": "No meat, poultry, or fish"
    },
    {
      "Type": "Health",
      "WebLabel": "Wheat-Free",
      "APIParameter": "wheat-free",
      "Definition": "No wheat, can have gluten though"
    },
    ///
    {
      "Type": "Diet",
      "WebLabel": "Balancede",
      "APIParameter": "balanced",
      "Definition": "Protein/Fat/Carb values in 15/35/50 ratio"
    },
    {
      "Type": "Diet",
      "WebLabel": "High-Fiber",
      "APIParameter": "high-fiber",
      "Definition": "More than 5g fiber per serving"
    },
    {
      "Type": "Diet",
      "WebLabel": "High-Protein",
      "APIParameter": "high-protein",
      "Definition": "More than 50% of total calories from proteins"
    },
    {
      "Type": "Diet",
      "WebLabel": "Low-Fat",
      "APIParameter": "low-fat",
      "Definition": "Less than 15% of total calories from fat"
    },
    {
      "Type": "Diet",
      "WebLabel": "Low-Carb",
      "APIParameter": "low-carb",
      "Definition": "Less than 20% of total calories from carbs"
    },
    {
      "Type": "Diet",
      "WebLabel": "Low-Sodium",
      "APIParameter": "low-sodium",
      "Definition": "Less than 140mg Na per serving"
    },
  ]

  const dietaryRestrictions = ["dairy-free", "keto-friendly", "peanut-free", "pescatarian", "vegetarian", "vegan", "paleo", "gluten-free", "sugar-conscious", "tree-nut-free", "wheat-free", "low-potassium", "kidney-friendly", "low-sugar", "red-meat-free", "no-oil-added", "no-shellfish", "no-mollusk", "no-oil-added","balanced","high-fiber","high-protein","low-carb","low-fat","low-sodium"];
  const allergies = ["crustacean-free", "egg-free", "fish-free", "fodmap-free", "lupine-free", "mollusk-free", "mustard-free", "sesame-free", "shellfish-free", "soy-free", "sulfite-free"];
  const dietaryRestrictionsData = [];
  const allergiesData = [];
  dataHealth.forEach(item => {
      if (dietaryRestrictions.includes(item["APIParameter"])) {
          dietaryRestrictionsData.push(item);
      } else if (allergies.includes(item["APIParameter"])) {
          allergiesData.push(item);
      }
  });
  // In kết quả
  console.log("Chế độ ăn kiêng:");
  console.log(dietaryRestrictionsData);

  console.log("\nDị ứng:");
  console.log(allergiesData);

  var array ={
    mealsDay :[],
    health:[],
    diet:[]
  };


  var q 			= '',
  healt 		= '',
  diet 		= '',
  calories	= '',
  breakfast   = '',
  lunch 		= '',
  dinner	    = '',
  dishBr	    = '',
  dishLn	    = '',
  dishDi	    = '',
  jsonConst   = '',
  jsonBrekf   = '',
  jsonLunch   = '',
  jsonDinner  = '',
  jsonHealth  = '',
  brekfastADD = `  "ENERC_KCAL": {
    "min": 100,
    "max": 600
  }`,
  lunchADD = `"ENERC_KCAL": {
    "min": 300,
    "max": 800
  }`,
  dinnerADD = `"ENERC_KCAL": {
    "min": 200,
    "max": 1000
  }`,

  nutrients	= '';
  $(".btn.btn-primary.analyze-demo").on('click', function(){
    var jsonMeal = plus();
    GoToSearch(jsonMeal);
  });

function plus(){

  if (array.health.length > 0) {
    jsonHealth = `{
        "health": [
            ${array.health.map(e => `"${e.toUpperCase().replace(/-/g, "_")}"`).join(",")}
        ]
    },`;
}
if (array.diet.length > 0) {
  jsonHealth +=  `{
      "diet": [
          ${array.diet.map(e => `"${e.toUpperCase().replace(/-/g, "_")}"`).join(",")}
      ]
  },`;
}

jsonHeathType = jsonHealth.slice(0,-1);




array.mealsDay.forEach(e =>  {
  console.log(e)
  if(e == 'Breakfast'){
    breakfast = '{"meal": [ "breakfast" ]}';
    jsonBrekf = '"Breakfast": {'+
                '   "accept": {'+
                '       "all": ['+
                '           '+breakfast+''+
                '       ]'+
                '   },'+
                '   "fit": {'+
                '       '+brekfastADD+''+
                '   }'+
                '},';

  } else if(e == 'Lunch'){
    lunch     = '{"meal": [ "lunch/dinner" ]}';
    jsonLunch = '"Lunch": {'+
                '   "accept": {'+
                '       "all": ['+
                '           '+lunch+''+
                '       ]'+
                '   },'+
                '   "fit": {'+
                '       '+lunchADD+''+
                '   }'+
                '},';
  } else if(e == 'Dinner'){
    dinner     = '{"meal": [ "lunch/dinner" ]}';
    jsonDinner = '"Dinner": {'+
                 '   "accept": {'+
                 '       "all": ['+
                 '          '+dinner+''+
                 '       ]'+
                 '   },'+
                 '   "fit": {'+
                 '       '+dinnerADD+''+
                 '   }'+
                 '},';
  }



})
jsonMealType = jsonBrekf+jsonLunch+jsonDinner;
jsonMealType = jsonMealType.slice(0,-1);
var jsonMeal = '{'+
'    "size": 7,'+
'    "plan": {'+
'        "accept": {'+
'            "all": ['+
'               '+jsonHeathType+''+
'            ]'+
'        },'+
'        "fit": {'+
'            '+jsonConst+''+
'        },'+
'        "sections": {'+
'            '+jsonMealType+''+
'        }'+
'    }'+
'}';
console.log(jsonMeal)
return jsonMeal;
}



//jsonMealType = jsonMealType.slice(0,-1);







  var myButton = document.querySelector('button.btn.btn-link[fdprocessedid="9u14zn"]');
  var setmeals = document.getElementById('setmeals');
  myButton.addEventListener('click', e => {
    setmeals.innerHTML='';
    setmeals.innerHTML=` <h2>bữa ăn mỗi ngày</h2>
    <div class="form-check">
        <input class="form-check-input" type="checkbox" value="Breakfast" id="Breakfast" onclick="handleCheckboxClick(this)">
        <label class="form-check-label" for="flexCheckDefault">
          Breakfast
        </label>
    </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="Lunch" id="Lunch" onclick="handleCheckboxClick(this)">
        <label class="form-check-label" for="flexCheckChecked">
          Lunch
        </label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="Dinner" id="Dinner" onclick="handleCheckboxClick(this)">
        <label class="form-check-label" for="flexCheckChecked">
          Dinner
        </label>
    </div>`,

    (array.mealsDay).forEach((e) =>{

      document.getElementById(e).checked = true;

    })
      console.log(array)
  })

    function handleCheckboxClick(checkbox) {

      var Ischeck = checkbox.checked;
      var selectedValue = checkbox.value;
      if (Ischeck) {
        if (array.mealsDay.indexOf(selectedValue) === -1) {
          array.mealsDay.push(selectedValue);

        }
      } else {
        var index = array.mealsDay.indexOf(selectedValue);
        if (index !== -1) {
          array.mealsDay.splice(index, 1);
        }
      }
    }
///////////////////////////////////////////////////////////////////////////////////

function CheckboxClickhealth(checkbox) {

  var Ischeck = checkbox.checked;
  var selectedValue = checkbox.value;
  var id = checkbox.id;
  if (Ischeck) {
    if (array.health.indexOf(selectedValue) === -1 && id =='Health') {
      array.health.push(selectedValue);

    }else if(array.diet.indexOf(selectedValue) === -1 && id =='Diet'){
      array.diet.push(selectedValue);

    }
  } else  {
    var index = array.health.indexOf(selectedValue);
    if (index !== -1) {
      array.splice(index, 1);
    }
  }

}

     var allergiesButton = document.querySelector('button.btn.btn-link[fdprocessedid="ppj92k"]');
     allergiesButton.addEventListener('click', e => {
      setmeals.innerHTML='';
        let fragment = []
      allergiesData.forEach((e) =>{

        const tableRow = create(e);
        fragment.push(tableRow)


      })
      setmeals.innerHTML=` <h2>bữa ăn mỗi ngày</h2>
      ${fragment.join('')}
      `;
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
       var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
       return new bootstrap.Tooltip(tooltipTriggerEl)
   });

    })

    const create = (obj) => {
      let html ;
      if (array.diet.includes(obj.APIParameter) || array.health.includes(obj.APIParameter) ) {
        html =  `  <div class="form-check form-check-inline">
      <input class="form-check-input"  type="checkbox" id="${obj.Type}" value="${obj.APIParameter}" onclick="CheckboxClickhealth(this)" checked>
      <label class="form-check-label" for="inlineCheckbox1" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="${obj.Definition}">${obj.WebLabel}</label>
    </div>`;
       } else {
        html =  `  <div class="form-check form-check-inline">
      <input class="form-check-input"  type="checkbox" id="${obj.Type}" value="${obj.APIParameter}" onclick="CheckboxClickhealth(this)" >
      <label class="form-check-label" for="inlineCheckbox1" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="${obj.Definition}">${obj.WebLabel}</label>
    </div>`;
        }

      return html;
  }

 //////////////////////////////////
     var allergiesButton = document.querySelector('button.btn.btn-link[fdprocessedid="akhoi"]');
     allergiesButton.addEventListener('click', e => {
      setmeals.innerHTML='';
        let fragment = []
        dietaryRestrictionsData.forEach((e) =>{

        const tableRow = create(e);
        fragment.push(tableRow)


      })
      setmeals.innerHTML=` <h2>bữa ăn mỗi ngày</h2>
      ${fragment.join('')}
      `;
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
       var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
       return new bootstrap.Tooltip(tooltipTriggerEl)
   });
  })


//////////////////////////////////////////


var allergiesButton = document.querySelector('button.btn.btn-link[fdprocessedid="x1t9sk"]');
allergiesButton.addEventListener('click', e => {
 setmeals.innerHTML='';

 setmeals.innerHTML=`  <div class="card-body">
 <h2>Daily Budget</h2>
 <div class="desc cal">Default value is selected base on min 1600 and max 2000 calorie diet. Please enter your preferred min/max values.</div>
 <!--input type="text" class="search cal"/> kcal -->
 <div class="mdesc-cal">
     <div class="range-slider">
         <span class="mdescs">min <input type="text" value="1000" class="search nut min" fdprocessedid="mc0ulf"> max <input type="text" value="2000" class="search nut max" fdprocessedid="6fgs9"> kcal</span>
     </div>
     <div class="range-check cal-check check-contain">
         <label class="checkbox-button">
             <input type="checkbox" class="nutrient-check" id="calories" data-measure="kcal" onclick="Checkboxcalo(this)">
         </label>
     </div>
 </div>
</div>`;
var listsen = document.getElementById('calories');
document.getElementById('calories').checked = localStorage.getItem('calories');


})


function Checkboxcalo(checkbox) {
  console.log(localStorage)
  var minValue = document.querySelector('input.search.nut.min').value;
  var maxValue = document.querySelector('input.search.nut.max').value;
  var Ischeck = checkbox.checked;
  if (Ischeck) {
    localStorage.setItem('calories', Ischeck);
    jsonConst = `"ENERC_KCAL": {
                "min": ${minValue},
                "max": ${maxValue}
                 }`;
  } else  {
    localStorage.setItem('calories', '');
    jsonConst =``;
    console.log(jsonConst,localStorage)
  }

}

$(".result-area").html('');

var clicks = document.querySelector('.clickseach');

//fooddemos

function GoToSearch(jsonMeal){
$.ajax({
  //url: 'https://api.edamam.com/api/meal-planner/v1/b26fb46d/select?app_id=469fc797&app_key=01c8217e070a97ba8180863e94daa8e6',     //recipe
  url: 'https://api.edamam.com/api/meal-planner/v1/e997f750/select?app_id=e997f750&app_key=a54674455b1a6cd4a3735c18d0d1e87e',       //meal-planner
  type: 'POST',
  data: jsonMeal,
  headers:{'Edamam-Account-User':'fooddemos','Content-Type': 'application/json'},
  dataType:'JSON',
  contentType: "application/json; charset=UTF-8",
  success: function(data) {

      //$('.openJSON').css('display', 'block');

      if(data.status == "OK") {

          var html = '<div class="foodresult" style:></div>'+
                     '<div class="table-res-recipe recipes-area row">'+
                     '	<div class="r-title text-center"><span>Your daily meal planner</span></div>';
                      var end = "no";

                     $.each(data.selection, function(i) {
                          if(end == "no"){
                              html += '<div class="col-md-1"></div>';
                              html += '<div class="col-md-11">';
                              html += '   <div class="row">';
                              $.each(data.selection[i], function(key,valueObj){
                                  $.each(valueObj, function(k,obj){
                                      if(k == "Breakfast"){
                                          html += '<div class="col-md-4">';
                                          html += '   <div class="key-title">'+k+'</div>';
                                          html += '</div>';
                                      }
                                  });
                                  $.each(valueObj, function(k,obj){
                                      if(k == "Lunch"){
                                          html += '<div class="col-md-4">';
                                          html += '   <div class="key-title">'+k+'</div>';
                                          html += '</div>';
                                      }
                                  });
                                  $.each(valueObj, function(k,obj){
                                      if(k == "Dinner"){
                                          html += '<div class="col-md-4">';
                                          html += '   <div class="key-title">'+k+'</div>';
                                          html += '</div>';
                                      }
                                  });
                                  end = "yes";
                              });
                              html += '   </div>';
                              html += '</div>';
                          }
                     });



          $.each(data.selection, function(i) {

              html += '<div class="col-md-1">';
              html += '   <div class="day-title">Day '+(i+1)+'</div>';
              html += '</div>';

              $.each(data.selection[i], function(key,valueObj){
                  html += '<div class="col-md-11">';
                  html += '   <div class="row">';

                  function printMeal(mealTitle, mealType){
                      html += '<div class="col-md-4">';
                      if (typeof(mealType["assigned"]) != "undefined") {
                          var param = mealType["assigned"].substr(mealType["assigned"].indexOf("#") + 1);
                          getRecipe(param);
                          html += output;
                      }
                      html += '</div>';
                  }

                  $.each(valueObj, function(k,obj){
                      if(k == "Breakfast"){
                          printMeal(k,obj);
                      }
                  });
                  $.each(valueObj, function(k,obj){
                      if(k == "Lunch"){
                          printMeal(k,obj);
                      }
                  });
                  $.each(valueObj, function(k,obj){
                      if(k == "Dinner"){
                          printMeal(k,obj);
                      }
                  });

                  html += '</div>';
                  html += '</div>';
              });

          });

          html += '</div>';

          $(".result-area").append(html);

          $('#collapse1, #collapse2, #collapse3, #collapse4, #collapse5, #collapse6, #collapse7, #collapse8').css('display', 'none');
          $('.search-row').css('display', 'block');
          $('.content-area').css('display', 'block');

      } else {
          // ERROR
          $('#errorModal').find('.modal-body').html('');
          $('#errorModal').find('.modal-body').html('<p>Ooops, nothing in our recipes database matches what you are searching for! Please try again.</p>');
          $('#errorModal').modal('show');

          $('#collapse1').css('display', 'block');
          $('#collapse1').addClass('err');

          $('#collapse2, #collapse3, #collapse4, #collapse5, #collapse6, #collapse7, #collapse8').css('display', 'none');

          $('.content-area').css('display', 'block');
          $(".result-area").css('display', 'none');

          $(".loading-area").css('display', 'none');
          return false;
      }
  },
  statusCode: {
      401: function() {
      },
      500: function() { //Bad request
          // ERROR
          $('#errorModal').find('.modal-body').html('');
          $('#errorModal').find('.modal-body').html('<p style="text-align: center;">HTTP Status 500 – Internal Server Error</p><pre>'+JSON.parse(JSON.stringify(jsonMeal))+'</pre>');
          $('#errorModal').modal('show');

          $('#collapse1').css('display', 'block');
          $('#collapse1').addClass('err');

          $('#collapse2, #collapse3, #collapse4, #collapse5, #collapse6, #collapse7, #collapse8').css('display', 'none');

          $('.content-area').css('display', 'block');
          $(".result-area").css('display', 'none');

          $(".loading-area").css('display', 'none');
          return false;
      }
  }
});







function getRecipe(param){
  var cal, pro, fat, carbs, img, ingrd, ingr, srv;

  $.ajax({
      url: 'https://api.edamam.com/api/recipes/v2/'+param+'?type=public&app_id=469fc797&app_key=01c8217e070a97ba8180863e94daa8e6',    //recipe
      //url: 'https://api.edamam.com/api/recipes/v2/'+param+'?type=public&app_id=b26fb46d&app_key=c887a724df8435d92a76f3ec8b3ba91a',  //meal-planner
      type: 'GET',
      headers: {"Edamam-Account-User": "edamam"},
      contentType: "application/json; charset=UTF-8",
      async: false,
      success: function(res) {

          if (typeof(res.recipe.images.SMALL.url) != "undefined") {
              img = '<img src="'+res.recipe.images.SMALL.url+'">';
          } else {img = ''}

          if (typeof(res.recipe.label) != "undefined") {
              title = res.recipe.label;
          } else {title = '-'}

          if (typeof(res.recipe.yield) != "undefined") {
              srv = Math.round(res.recipe.yield);
          } else {srv = 0}

          if (typeof(res.recipe.dietLabels) != "undefined") {
              dietLabels = String(res.recipe.dietLabels);
              dietLabels = dietLabels.split(',').join(' &bull; ');
              dietLabels = dietLabels.split('-').join(' ');
          } else {dietLabels = ''}

          if (typeof(res.recipe.healthLabels) != "undefined") {
              healthLabels = String(res.recipe.healthLabels);
              healthLabels = healthLabels.split(',').join(' &bull; ');
              healthLabels = healthLabels.split('-').join(' ');
          } else {healthLabels = ''}

          if ((healthLabels != '')&&(dietLabels != '')){
              labels = dietLabels+' &bull; '+healthLabels;
          } else if((healthLabels == '')&&(dietLabels != '')){
              labels = dietLabels;
          } else if((healthLabels != '')&&(dietLabels == '')){
              labels = healthLabels;
          } else{
              labels = '';
          }

          if (typeof(res.recipe.totalNutrients.ENERC_KCAL.quantity) != "undefined") {
              cal = Math.floor(res.recipe.totalNutrients.ENERC_KCAL.quantity/srv);
          } else {cal = ''}
          if (typeof(res.recipe.totalNutrients.PROCNT.quantity) != "undefined") {
              pro = Math.floor(res.recipe.totalNutrients.PROCNT.quantity/srv);
          } else {pro = ''}
          if (typeof(res.recipe.totalNutrients.FAT.quantity) != "undefined") {
              fat = Math.floor(res.recipe.totalNutrients.FAT.quantity/srv);
          } else {fat = ''}
          if (typeof(res.recipe.totalNutrients.CHOCDF) != "undefined") {
              carbs = Math.floor(res.recipe.totalNutrients.CHOCDF.quantity/srv);
          } else {carbs = ''}
          if (typeof(res.recipe.totalNutrients.CHOLE) != "undefined") {
              CHOLE = Math.floor(res.recipe.totalNutrients.CHOLE.quantity/srv);
          } else {CHOLE = ''}
          if (typeof(res.recipe.totalNutrients.NA) != "undefined") {
              NA = Math.floor(res.recipe.totalNutrients.NA.quantity/srv);
          } else {NA = ''}
          if (typeof(res.recipe.totalNutrients.CA) != "undefined") {
              CA = Math.floor(res.recipe.totalNutrients.CA.quantity/srv);
          } else {CA = ''}
          if (typeof(res.recipe.totalNutrients.MG) != "undefined") {
              MG = Math.floor(res.recipe.totalNutrients.MG.quantity/srv);
          } else {MG = ''}
          if (typeof(res.recipe.totalNutrients.K) != "undefined") {
              K = Math.floor(res.recipe.totalNutrients.K.quantity/srv);
          } else {K = ''}
          if (typeof(res.recipe.totalNutrients.FE) != "undefined") {
              FE = Math.floor(res.recipe.totalNutrients.FE.quantity/srv);
          } else {FE = ''}

          output= '<div class="nutr-block">'+
                  '	<div class="row">'+
                  '		<div class="col-md-12">'+
                  '			<div class="recipe-title">'+title+'</div>'+
                  '		</div>'+
                  '		<div class="col-md-6">'+
                  '			<div class="recipe-ico"></div>'+
                  '			<div><a href="'+res.recipe.shareAs+'" target="_new">'+img+'</a></div>'+
                  '		</div>'+
                  '   	<div class="col-md-6">'+
                  '			<div class="serv">'+srv+' servings</div>'+
                  '			<div class="daily-cal-area">'+
                  '				<div class="daily-cal">'+cal+'</div> kcal'+
                  '			</div>'+
                  //'		</div>'+
                  //'   	<div class="col-md-12">'+
                  '   		<ul class="nutr-left">'+
                  '   			<li class="protein">'+
                  '   				<span>Protein</span>'+
                  '					<span>'+pro+' g</span>'+
                  '				</li>'+
                  '				<li class="fat">'+
                  '					<span>Fat</span>'+
                  '					<span>'+fat+' g</span>'+
                  '				</li>'+
                  '				<li class="carbs">'+
                  '					<span>Carb</span>'+
                  '					<span>'+carbs+' g</span>'+
                  '				</li>'+
                  '   		</ul>'+
                  '		</div>'+
                  '	</div>'+
                  '</div>';

          return output;
      }
  });
}
}
